(function(w,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","vue","dayjs"],e):(w=typeof globalThis<"u"?globalThis:w||self,e(w.InfiniteCalendarGrid={},w.Vue,w.dayjs))})(this,function(w,e,k){"use strict";const S=typeof window<"u"&&typeof document<"u"?window:void 0,E=(i,s)=>{const a=new Date(Date.UTC(2017,0,2)),o=[];for(let r=0;r<7;r++)o.push(a.toLocaleDateString(i,{weekday:"short"})),a.setDate(a.getDate()+1);return s||o.unshift(o.pop()),o};function _(i,s,a){let o=0,r=!1,h=0,u=null;const d=10,m=10;function y(t){const f=-t.deltaY,p=Math.abs(f);p<m||t.timeStamp-h<300&&r||(h=t.timeStamp,o<p&&!r?(f<-d?s():f>d&&a(),g(p),u&&clearTimeout(u),u=setTimeout(()=>{o===p&&l()},1e3)):p<d&&l())}function g(t){o=t,r=!0}function l(){o=d,r=!1}const c=()=>{i.value&&i.value.removeEventListener("wheel",y)},n=e.watch(i,t=>{c(),t&&t.addEventListener("wheel",y)},{immediate:!0,flush:"post"});e.getCurrentScope()&&e.onScopeDispose(()=>{c(),n()})}function C(i,s={width:0,height:0}){const a=S;let o;const r=a&&"ResizeObserver"in a,h=e.ref(s.width),u=e.ref(s.height),d=([g])=>{const l=g.contentBoxSize;if(l){const c=Array.isArray(l)?l:[l];h.value=c.reduce((n,{inlineSize:t})=>n+t,0),u.value=c.reduce((n,{blockSize:t})=>n+t,0)}else h.value=g.contentRect.width,u.value=g.contentRect.height},m=()=>{o&&(o.disconnect(),o=void 0)},y=e.watch(i,g=>{m(),r&&a&&(o=new ResizeObserver(d),g&&o.observe(g))},{immediate:!0,flush:"post"});return e.onMounted(()=>{i.value&&(h.value="offsetWidth"in i.value?i.value.offsetWidth:s.width,u.value="offsetHeight"in i.value?i.value.offsetHeight:s.height)}),e.getCurrentScope()&&e.onScopeDispose(()=>{m(),y()}),{width:h,height:u}}function M(i,s,a){const o=e.ref(1),r=e.ref(!0),h=e.ref(!0),{height:u}=C(i),d=e.computed(()=>u.value/6),m=e.ref(k()),y=e.computed(()=>{const t=m.value.startOf("M"),f=t.get("d")+-a,p=f<0?7+f:f;return t.add(-(6*7+p),"d")}),g=e.computed(()=>new Array(6*7*3).fill(null).map((t,f)=>{const p=y.value.add(f,"d").toDate(),D=p.toLocaleDateString();return{localeDate:D,timestamp:p.getTime(),isWeekend:[0,6].includes(p.getDay()),isCurrent:new Date().toLocaleDateString()===D,isFirstDay:p.getDate()===1,isCurrentMonth:p.getMonth()===m.value.get("M")}}));e.onMounted(()=>{s.value&&(h.value=!1,s.value.style.transform=`translate3d(0px, ${-s.value.clientHeight}px, 0px)`)}),_(i,()=>{r.value&&o.value<2&&o.value++},()=>{r.value&&o.value>0&&o.value--});const n=t=>{if(s.value){const f=s.value.querySelectorAll(".icg-months-grid-day--first-day")[t];f instanceof HTMLElement&&(s.value.style.transform=`translate3d(0px, ${-f.offsetTop}px, 0px)`)}};return e.watch(o,t=>{t===1?n(t):s.value&&(h.value=!0,r.value=!1,s.value.addEventListener("transitionend",()=>{h.value=!1,r.value=!0,m.value=m.value.add(t===0?-1:1,"month"),e.nextTick(()=>{o.value=1})},{once:!0}),n(t))}),e.watch(h,t=>{s.value&&(s.value.style.transitionProperty=t?"transform":"none")}),e.watch(d,()=>{n(1)},{flush:"post"}),{cellHeight:d,activeMonth:m,daysInCalendar:g}}const L={class:"icg"},T={class:"icg-header"},x={class:"icg-month"},b={class:"icg-controls"},W=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[e.createElementVNode("path",{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"})],-1)],B=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",height:".8rem",viewBox:"0 0 320 512"},[e.createElementVNode("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"})],-1)],N={class:"icg-weekdays"},V=e.defineComponent({__name:"InfiniteCalendarGrid",props:{firstDayOfWeek:{default:0},locale:{default:"en-US"},todayLabel:{default:"Today"},items:{},fieldWithDate:{}},emits:["changeInterval"],setup(i,{emit:s}){const a=i,o=s,r=e.ref(null),h=e.ref(null),{cellHeight:u,activeMonth:d,daysInCalendar:m}=M(r,h,a.firstDayOfWeek),y=E(a.locale,a.firstDayOfWeek),g=e.computed(()=>{const l={};for(const c of a.items){const n=c[a.fieldWithDate];if(typeof n=="string"||typeof n=="number"){const t=new Date(n);if(!isNaN(t.getTime())){const f=t.toLocaleDateString();l[f]?l[f].push(c):l[f]=[c]}}}return l});return e.watch(m,l=>{o("changeInterval",{start:l[0].timestamp,end:l[l.length-1].timestamp})},{immediate:!0,flush:"post"}),(l,c)=>(e.openBlock(),e.createElementBlock("div",L,[e.createElementVNode("div",T,[e.createElementVNode("div",x,e.toDisplayString(e.unref(d).toDate().toLocaleDateString(a.locale,{year:"numeric",month:"long"}).replace("Ð³.","")),1),e.createElementVNode("div",b,[e.createElementVNode("button",{onClick:c[0]||(c[0]=n=>d.value=e.unref(d).add(-1,"M"))},W),e.createElementVNode("button",{onClick:c[1]||(c[1]=n=>d.value=e.unref(k)())},e.toDisplayString(a.todayLabel),1),e.createElementVNode("button",{onClick:c[2]||(c[2]=n=>d.value=e.unref(d).add(1,"M"))},B)])]),e.createElementVNode("div",N,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(y),(n,t)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(["icg-weekdays-cell",{"icg-weekdays-cell--weekend":t===(a.firstDayOfWeek?5:0)||t===6}])},e.toDisplayString(n),3))),128))]),e.createElementVNode("div",{ref_key:"wrapperRef",ref:r,class:"icg-wrapper"},[e.createElementVNode("div",{ref_key:"containerRef",ref:h,class:"icg-months-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),n=>(e.openBlock(),e.createElementBlock("div",{key:n.timestamp,class:e.normalizeClass(["icg-months-grid-day",{"icg-months-grid-day--active-month":n.isCurrentMonth,"icg-months-grid-day--first-day":n.isFirstDay,"icg-months-grid-day--weekend":n.isWeekend,"icg-months-grid-day--current":n.isCurrent}]),style:e.normalizeStyle({height:`${e.unref(u)}px`})},[e.renderSlot(l.$slots,"default",e.normalizeProps(e.guardReactiveProps({date:n,items:g.value[n.localeDate]})))],6))),128))],512)],512)]))}});w.InfiniteCalendarGrid=V,Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})});
